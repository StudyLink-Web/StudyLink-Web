import{c as m,r as d,j as e}from"./react-main.js";import{C as k}from"./react-main-fGToQEP1.js";const N=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],h=m("bell",N);const w=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],g=m("x",w),R=({isOpen:c,onClose:f,onUnreadCountChange:i})=>{const[l,o]=d.useState([]),[b,n]=d.useState(!1),x=d.useCallback(async()=>{n(!0);try{const t=await fetch("/api/notifications");if(t.ok){const a=await t.json();o(a),i(a.filter(r=>!r.isRead).length)}}catch(t){console.error("Failed to fetch notifications:",t)}finally{n(!1)}},[i]);d.useEffect(()=>{c&&x()},[c,x]);const u=async t=>{try{if((await fetch(`/api/notifications/${t}/read`,{method:"PUT"})).ok){const r=l.map(s=>s.id===t?{...s,isRead:!0}:s);o(r),i(r.filter(s=>!s.isRead).length)}}catch(a){console.error("Failed to mark as read:",a)}},p=async()=>{try{if((await fetch("/api/notifications/read-all",{method:"PUT"})).ok){const a=l.map(r=>({...r,isRead:!0}));o(a),i(0)}}catch(t){console.error("Failed to mark all as read:",t)}},j=t=>{const a=new Date(t),s=Math.floor((new Date().getTime()-a.getTime())/1e3);return s<60?"방금 전":s<3600?`${Math.floor(s/60)}분 전`:s<86400?`${Math.floor(s/3600)}시간 전`:`${Math.floor(s/86400)}일 전`};return c?e.jsx("div",{className:"fixed inset-y-0 right-0 w-80 sm:w-96 bg-white/80 dark:bg-slate-900/90 backdrop-blur-xl border-l border-white/20 dark:border-white/5 z-[10000] shadow-2xl animate-in slide-in-from-right duration-300",children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-white/5 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-xl",children:e.jsx(h,{size:20,className:"text-blue-500"})}),e.jsx("h2",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"알림 센터"})]}),e.jsx("button",{onClick:f,className:"p-2 hover:bg-slate-100 dark:hover:bg-white/5 rounded-lg transition-colors",children:e.jsx(g,{size:20,className:"text-slate-500 dark:text-slate-400"})})]}),l.length>0&&e.jsx("div",{className:"px-6 py-3 border-b border-slate-200 dark:border-white/5 flex justify-end",children:e.jsxs("button",{onClick:p,className:"text-xs font-medium text-blue-500 hover:text-blue-600 flex items-center gap-1",children:[e.jsx(k,{size:14})," 모두 읽음 처리"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 custom-scrollbar",children:b?e.jsxs("div",{className:"flex flex-col items-center justify-center h-40 space-y-3",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-sm text-slate-500",children:"알림을 불러오는 중..."})]}):l.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center space-y-4 px-6",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 dark:bg-white/5 rounded-full flex items-center justify-center",children:e.jsx(h,{size:32,className:"text-slate-300 dark:text-slate-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-slate-900 dark:text-white",children:"새로운 알림이 없습니다"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"중요한 업데이트가 있으면 여기에 표시됩니다."})]})]}):l.map(t=>e.jsx("div",{className:`p-4 rounded-2xl border transition-all duration-200 ${t.isRead?"bg-transparent border-slate-100 dark:border-white/5 grayscale-[0.5] opacity-70":"bg-white dark:bg-white/5 border-blue-100 dark:border-blue-500/20 shadow-sm"}`,children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:`mt-1 h-2 w-2 rounded-full shrink-0 ${t.isRead?"bg-transparent":"bg-blue-500 animate-pulse"}`}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider text-blue-500/70",children:t.type}),e.jsx("span",{className:"text-[10px] text-slate-400",children:j(t.createdAt)})]}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 leading-relaxed font-medium",children:t.message}),!t.isRead&&e.jsx("button",{onClick:()=>u(t.id),className:"mt-3 text-[10px] font-bold text-blue-500 flex items-center gap-1 hover:underline",children:"읽음 처리"})]})]})},t.id))})]})}):null};export{R as default};
