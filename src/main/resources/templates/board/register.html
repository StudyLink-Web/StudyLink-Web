<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">

<body>
<div layout:fragment="content" class="content_box">
    <h1>대학생활 등록하기</h1>

    <form th:action="@{/board/register}" method="post" enctype="multipart/form-data">
        <!-- CSRF: Spring Security면 이 input 없어도 th:action이 자동 처리되는 경우가 많지만,
             네가 이미 넣어놨으니 유지해도 됨 -->
        <input type="hidden" name="_csrf" th:value="${_csrf.token}" />

        <!-- ✅ userId는 폼에서 받지 않음 (서버에서 로그인 PK로 세팅) -->
        <!-- <input type="hidden" name="userId" ...>  <-- 삭제 -->

        <div class="mb-3">
            <label for="title" class="form-label">제목</label>
            <input type="text" name="title" class="form-control" id="title"
                   placeholder="제목을 입력하세요." required>
        </div>

        <!-- ✅ 작성자: userId가 아니라 writer 로 받기 -->
        <div class="mb-3">
            <label for="writer" class="form-label">작성자</label>
            <input type="text" name="writer" class="form-control" id="writer"
                   placeholder="작성자를 입력하세요."
                   th:value="${#authentication != null ? #authentication.name : ''}"
                   readonly>
        </div>

        <div class="mb-3">
            <label for="department" class="form-label">학과</label>
            <input type="text" name="department" class="form-control" id="department"
                   placeholder="학과를 입력하세요.">
        </div>

        <div class="mb-3">
            <label for="content" class="form-label">내용</label>
            <textarea class="form-control" name="content" id="content" rows="5"
                      placeholder="내용을 입력하세요." required></textarea>
        </div>

        <!-- file upload -->
        <div class="mb-3">
            <input type="file" name="files" class="form-control" id="file" multiple style="display:none">
            <button type="button" class="btn btn-danger" id="trigger">파일 업로드</button>
        </div>

        <!-- file list print -->
        <div class="mb-3" id="fileZone"></div>

        <button type="submit" class="btn btn-primary" id="regBtn">등록</button>
        <a th:href="@{/board/list}" class="btn btn-secondary">취소</a>
    </form>

    <script th:src="@{/js/board.js}"></script>
</div>
</body>
</html>
