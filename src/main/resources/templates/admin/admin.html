<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{layout/layout}">

<div layout:fragment="content" class="container-md">
	<div class="row">
		<!-- Sidebar -->
		<nav class="col-2 adminSidebar p-0">
			<h5 class="text-white text-center py-3 border-bottom">ADMIN</h5>
			<a th:href="@{/admin/admin}"
			   th:classappend="${currentMenu == 'admin'} ? 'active' : ''"
			   class="adminSidebarMenu">
				대시보드
			</a>
			<a th:href="@{/admin/user}"
			   th:classappend="${currentMenu == 'user'} ? 'active' : ''"
			   class="adminSidebarMenu">
				회원 관리
			</a>
			<a th:href="@{/admin/payment}"
			   th:classappend="${currentMenu == 'payment'} ? 'active' : ''"
			   class="adminSidebarMenu">
				결제 내역
			</a>
			<a th:href="@{/admin/exchange}"
			   th:classappend="${currentMenu == 'exchange'} ? 'active' : ''"
			   class="adminSidebarMenu">
				환전 관리
			</a>
			<a th:href="@{/admin/notice}"
			   th:classappend="${currentMenu == 'notice'} ? 'active' : ''"
			   class="adminSidebarMenu">
				알림 / 공지
			</a>
			<a th:href="@{/admin/application}"
			   th:classappend="${currentMenu == 'application'} ? 'active' : ''"
			   class="adminSidebarMenu">
				문의 내역
			</a>
		</nav>

		<!-- Main -->
		<main class="col-10 p-4">
			<!-- ================= 일일 핵심 지표 ================= -->
			<h4 class="fw-bold mb-3">일일 핵심 지표</h4>
			<div class="row mb-4">
				<div class="col-md">
					<div class="card kpi-card shadow-sm">
						<div class="card-body">
							<div class="kpi-label">결제 금액</div>
							<div class="kpi-value" id="todayPaymentAmount" th:text="${todayPaymentAmount} + '원'"></div>
						</div>
					</div>
				</div>
				<div class="col-md">
					<div class="card kpi-card shadow-sm">
						<div class="card-body">
							<div class="kpi-label">결제 수</div>
							<div class="kpi-value" id="todayPaymentCount" th:text="${todayPaymentCount}"></div>
						</div>
					</div>
				</div>
				<div class="col-md">
					<div class="card kpi-card shadow-sm">
						<div class="card-body">
							<div class="kpi-label">환전 금액</div>
							<div class="kpi-value" id="todayExchangeAmount" th:text="${todayExchangeAmount} + '원'"></div>
						</div>
					</div>
				</div>
				<div class="col-md">
					<div class="card kpi-card shadow-sm">
						<div class="card-body">
							<div class="kpi-label">환전 수</div>
							<div class="kpi-value" id="todayExchangeCount" th:text="${todayExchangeRequestCount}"></div>
						</div>
					</div>
				</div>
				<div class="col-md">
					<div class="card kpi-card shadow-sm">
						<div class="card-body">
							<div class="kpi-label">신규 가입자</div>
							<div class="kpi-value" id="todaySignupCount" th:text="${todayNewUsers}"></div>
						</div>
					</div>
				</div>
			</div>

			<!-- ================= 회원 ================= -->
			<div class="d-flex justify-content-between align-items-center mb-3">
				<h4 class="fw-bold mb-0">회원</h4>
				<div class="btn-group btn-group-sm">
					<button class="btn btn-outline-primary active" data-category="user" data-period="7">7일</button>
					<button class="btn btn-outline-primary" data-category="user" data-period="30">30일</button>
				</div>
			</div>


			<div class="row mb-5">
				<div class="col-md-6">
					<div class="card shadow-sm">
						<div class="card-body">
							<h6 class="card-title" id="userDailyTitle">7일간 일별 가입자 수</h6>
							<canvas id="userDailyChart"></canvas>
						</div>
					</div>
				</div>


				<div class="col-md-6">
					<div class="card shadow-sm">
						<div class="card-body">
							<h6 class="card-title" id="userCumulativeTitle">7일간 누적 가입자 수</h6>
							<canvas id="userCumulativeChart"></canvas>
						</div>
					</div>
				</div>
			</div>


			<!-- ================= 결제 ================= -->
			<div class="d-flex justify-content-between align-items-center mb-3">
				<h4 class="fw-bold mb-0">결제</h4>
				<div class="btn-group btn-group-sm">
					<button class="btn btn-outline-primary active" data-category="payment" data-period="7">7일</button>
					<button class="btn btn-outline-primary" data-category="payment" data-period="30">30일</button>
				</div>
			</div>


			<div class="row mb-5">
				<div class="col-md-6">
					<div class="card shadow-sm">
						<div class="card-body">
							<h6 class="card-title" id="paymentDailyTitle">7일간 일별 결제 금액</h6>
							<canvas id="paymentDailyChart"></canvas>
						</div>
					</div>
				</div>


				<div class="col-md-6">
					<div class="card shadow-sm">
						<div class="card-body">
							<h6 class="card-title" id="paymentCumulativeTitle">7일간 누적 결제 금액</h6>
							<canvas id="paymentCumulativeChart"></canvas>
						</div>
					</div>
				</div>
			</div>


			<!-- ================= 환전 ================= -->
			<div class="d-flex justify-content-between align-items-center mb-3">
				<h4 class="fw-bold mb-0">환전</h4>
				<div class="btn-group btn-group-sm">
					<button class="btn btn-outline-primary active" data-category="exchange" data-period="7">7일</button>
					<button class="btn btn-outline-primary" data-category="exchange" data-period="30">30일</button>
				</div>
			</div>


			<div class="row mb-5">
				<div class="col-md-6">
					<div class="card shadow-sm">
						<div class="card-body">
							<h6 class="card-title" id="exchangeDailyTitle">7일간 일별 환전 금액</h6>
							<canvas id="exchangeDailyChart"></canvas>
						</div>
					</div>
				</div>


				<div class="col-md-6">
					<div class="card shadow-sm">
						<div class="card-body">
							<h6 class="card-title" id="exchangeCumulativeTitle">7일간 누적 환전 금액</h6>
							<canvas id="exchangeCumulativeChart"></canvas>
						</div>
					</div>
				</div>
			</div>
		</main>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script th:inline="javascript">
		const userChartData = /*[[${userChartDTO}]]*/;
		const paymentChartData = /*[[${paymentChartDTO}]]*/;
		const exchangeChartData = /*[[${exchangeChartDTO}]]*/;
	</script>
	<script src="/js/admin.js"></script>
</div>
