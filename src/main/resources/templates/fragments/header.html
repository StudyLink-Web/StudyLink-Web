<header th:fragment="header"
		class="site-header"
		xmlns:th="http://www.thymeleaf.org"
		xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

	<div class="header">
		<nav class="header-inner">

			<!-- ์ผ์ชฝ: ๋ก๊ณ -->
			<div class="header-left">
				<a class="navbar-brand" href="/">
					<img src="/img/logo_img.png" alt="StudyLink" style="height: 40px;">
					<span class="brand-name">StudyLink</span>
				</a>
			</div>

			<!-- ๋ค๋น๊ฒ์ด์ ๋ฉ๋ด -->
			<!-- ๊ฐ์ด๋ฐ: ๋ฉ์ธ ๋ฉ๋ด -->
			<nav class="header-center">
				<ul class="main-nav">

					<li>
						<a href="/">ํ</a>
					</li>

					<li>
						<a href="/board/board_list">๋ํ์ํ ์๋ณด</a>
					</li>

					<li>
						<a href="/room/list">๋ฉํ๋ง</a>
					</li>

					<li>
						<a href="/chatbot">AI ์๋ด๋ด</a>
					</li>

					<!-- ๋ก๊ทธ์ธ ์ -->
					<li th:if="${#authorization.expression('isAnonymous()')}">
						<a href="/login">๋ก๊ทธ์ธ</a>
					</li>

					<li th:if="${#authorization.expression('isAnonymous()')}">
						<a href="/signup">ํ์๊ฐ์</a>
					</li>

					<!-- ========== ๋ก๊ทธ์ธ ํ: ๋ง์ดํ์ด์ง / ๋ก๊ทธ์์ ========== -->
					<li class="nav-item dropdown" th:if="${#authorization.expression('isAuthenticated()')}">
						<a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
						   data-bs-toggle="dropdown" aria-expanded="false">
							<!-- OAuth2 ๋ก๊ทธ์ธ๊ณผ ํผ ๋ก๊ทธ์ธ ๋ชจ๋ ์ง์ -->
							<i class="bi bi-person-circle"></i>
							<span th:text="${
                                #authentication.principal instanceof T(org.springframework.security.oauth2.core.user.DefaultOAuth2User)
                                  ? #authentication.principal.attributes['name']
                                  : #authentication.name
                            }">
                                ์ฌ์ฉ์๋ช
                            </span> โผ
						</a>

						<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
							<!-- โญ ๋ง์ดํ์ด์ง -->
							<li>
								<a class="dropdown-item" href="/mypage">
									<i class="bi bi-person-circle"></i> ๋ง์ดํ์ด์ง
								</a>
							</li>

							<!-- ํ๋กํ ์์ -->
							<li>
								<a class="dropdown-item" href="/mypage/profile">
									<i class="bi bi-pencil"></i> ํ๋กํ ์์
								</a>
							</li>

							<!-- โญ ๋ํ์ ์ธ์ฆ -->
							<li>
								<a class="dropdown-item" href="/mypage/verification">
									<i class="bi bi-check-circle"></i> ๋ํ์ ์ธ์ฆ
								</a>
							</li>

							<!-- ๊ตฌ๋ถ์ -->
							<li><hr class="dropdown-divider"></li>

							<!-- ๊ณ์ ์ค์ -->
							<li>
								<a class="dropdown-item" href="/mypage/settings">
									<i class="bi bi-gear"></i> ๊ณ์ ์ค์
								</a>
							</li>

							<!-- ๋ก๊ทธ์์ -->
							<li>
								<form method="post" th:action="@{/logout}" style="display: inline; margin: 0;">
									<button type="submit" class="dropdown-item"
											style="background: none; border: none; cursor: pointer; text-align: left; width: 100%; padding: 10px 16px; margin: 0;">
										<i class="bi bi-box-arrow-right"></i> ๋ก๊ทธ์์
									</button>
								</form>
							</li>
						</ul>
					</li>
				</ul>
			</nav>

			<!-- ๋ณ๊ฒฝ: sec:authorize โ th:if + sec:authorize -->
			<!-- ๋ก๊ทธ์ธ ์ -->
			<!--
            <ul class="header-nav" th:if="${#authorization.expression('isAnonymous()')}">
               <li>
                  <a th:href="@{/login}" class="header-nav-link">๋ก๊ทธ์ธ</a>
               </li>
               <li>
                  <a th:href="@{/signup}" class="header-nav-link">ํ์๊ฐ์</a>
               </li>
            </ul>
            -->

			<!-- ๋ก๊ทธ์ธ ํ -->
			<!--
            <ul class="header-nav" th:if="${#authorization.expression('isAuthenticated()')}">
               <li><a th:href="@{/dashboard}" class="header-nav-link">๋์๋ณด๋</a></li>
               <li><a th:href="@{/questions}" class="header-nav-link">์ง๋ฌธ๋ชฉ๋ก</a></li>
               <li><a th:href="@{/my-page}" class="header-nav-link">๋ง์ดํ์ด์ง</a></li>

               <li class="dropdown">
                  <a href="#"
                     class="header-nav-link dropdown-toggle"
                     id="userDropdown"
                     role="button"
                     data-bs-toggle="dropdown"
                     aria-expanded="false">
            -->
			<!-- ๐ค <span th:text="${#authentication.principal.attributes['name']}"></span> --->
			<!-- ๐ค <span th:text="${#authentication.name}"></span> -->

			<!-- OAuth2 ๋ก๊ทธ์ธ(Google/Kakao/Naver)์์๋ name, ๋ก์ปฌ ํผ ๋ก๊ทธ์ธ์์๋ username ์ฌ์ฉ -->
			<!--
            <span th:with="userName=${
               #authentication.principal.attributes != null && #authentication.principal.attributes['name'] != null
                  ? #authentication.principal.attributes['name']
                  : #authentication.name
            }" th:text="${userName}">
            </span>
            -->
			<!--
                     ๐ค <span th:text="${
                        #authentication.principal instanceof T(org.springframework.security.oauth2.core.user.DefaultOAuth2User)
                          ? #authentication.principal.attributes['name']
                          : #authentication.name
                     }">
                     </span>


                  </a>

                  <ul class="dropdown-menu dropdown-menu-end">
                     <li><a class="dropdown-item" href="/profile">ํ๋กํ</a></li>
                     <li><a class="dropdown-item" href="/settings">์ค์</a></li>
                     <li><hr class="dropdown-divider"></li>
                     <li>
                        <form method="post" th:action="@{/logout}" style="display: inline; width: 100%;">
                           <button type="submit" class="dropdown-item" style="background: none; border: none; cursor: pointer; text-align: left; width: 100%; padding: 10px 16px;">
                              ๋ก๊ทธ์์
                           </button>
                        </form>
                     </li>
                  </ul>
               </li>
            </ul>
            -->

			<!-- D-Day -->
			<!-- header.html ๋ง์ง๋ง ๋ถ๋ถ์ ์ถ๊ฐ/์์ -->
			<div class="header-buttons">
				<!-- ๋ก๊ทธ์ธ ์ํ์ผ ๋ -->
				<th:block th:if="${user != null}">
					<div class="dday">
						<p>์๋ฅ๊น์ง</p>
						<span th:attr="data-dday=${dday}" th:text="${dday}"></span>
					</div>
				</th:block>

				<th:block th:if="${user == null}">
					<div class="dday">
						<p>์๋ฅ๊น์ง</p>
						<span th:attr="data-dday=${dday}" th:text="${dday}"></span>
					</div>
				</th:block>
			</div>

		</nav>
	</div>
</header>
